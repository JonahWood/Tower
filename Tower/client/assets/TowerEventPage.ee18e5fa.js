import{_ as C,i as I,b as x,w as T,d as m,j as g,P as i,l as v,m as S,e as A,C as B,c as s,a as t,q as h,t as _,s as y,F as p,r as k,u as D,v as P,x as V,y as N,o as a,f as F,z as M,A as d,p as U,g as j,h as L}from"./index.59b637c3.js";const O={setup(){const c=I({}),n=N(),f=M();async function e(){try{await g.getComments(n.params.eventId)}catch(o){i.error(o.message),v.error("this is from the getComments:",o)}}async function w(){try{const o=n.params.eventId;await g.getOneEventById(o)}catch{i.error("we don't take kindly to your types around here"),f.push("/")}}async function b(){try{await g.getTicketsByEvent(n.params.eventId)}catch(o){i.error(o.message),v.error(o)}}return x(()=>{w(),e(),b()}),T(()=>{n.params.eventId&&w()}),{liveComment:c,account:m(()=>d.account),towerEvent:m(()=>d.towerEvent),comments:m(()=>d.comments),attendees:m(()=>d.activeUsers),isAttending:m(()=>d.activeUsers.find(o=>{var l;return o.accountId==((l=d.account)==null?void 0:l.id)})),async cancelEvent(){try{await g.cancelEvent(n.params.eventId)}catch(o){i.error(o.message),v.error("cancelEvent:",o)}},async createComment(){try{c.value.eventId=n.params.eventId,await S.createComment(c.value),c.value={}}catch(o){i.error(o.message),v.error(o)}},async createTicket(){try{await A.createTicket({eventId:n.params.eventId})}catch(o){i.error(o.message),v.error(o)}}}},components:{Comment:B}},u=c=>(U("data-v-d6b89b54"),c=c(),j(),c),R={key:0,class:"container"},q={class:"row text-light"},z={class:"col-12"},G={class:"big-img rounded"},H={class:"row ps-2 py-2"},J={class:"col-4"},K=["src","alt"],Q={class:"col-8"},W={class:"text-secondary"},X={class:"lighter-text-weight"},Y={class:"mt-3 fw-bold text-success"},Z={key:0,class:"ultra-margin"},$={class:"heavier-shadow text-danger"},ee=h("This event is no longer available. "),te={key:0},oe={key:1,class:"ultra-margin"},ne={class:"heavier-shadow text-success"},se=h(" spots left. "),ae=h("Attend "),re=u(()=>t("i",{class:"mdi mdi-plus-box"},null,-1)),ce=[ae,re],ie=h("Attend "),de=u(()=>t("i",{class:"mdi mdi-plus-box"},null,-1)),le=[ie,de],me={key:0,class:"col-12 my-3 attendee-background rounded"},ve=u(()=>t("h6",null,"Attendees:",-1)),_e=["title","src","alt"],he={class:"container"},ue={class:"row mt-5 comment-background p-2 rounded"},ge={class:"offset-1 col-10 mb-5"},ye={class:"form-floating"},we=u(()=>t("label",{class:"text-dark"},"Tell the People...",-1)),pe=u(()=>t("div",{class:"d-flex justify-content-end"},[t("button",{class:"submit-button rounded mt-1",type:"submit",title:"Submit Comment"},"post comment")],-1));function fe(c,n,f,e,w,b){var l,E;const o=L("Comment");return a(),s(p,null,[e.towerEvent?(a(),s("div",R,[t("div",q,[t("div",z,[t("div",G,[t("div",H,[t("div",J,[t("img",{class:"img-fluid top-img rounded",src:e.towerEvent.coverImg,alt:e.towerEvent.name},null,8,K)]),t("div",Q,[t("h2",null,[h(_(e.towerEvent.name)+" ",1),((l=e.towerEvent)==null?void 0:l.creatorId)==((E=e.account)==null?void 0:E.id)&&!e.towerEvent.isCanceled?(a(),s("button",{key:0,class:"bg-danger bg-gradient text-light p-1 cancel rounded ms-1",onClick:n[0]||(n[0]=r=>e.cancelEvent())},"Cancel Event?")):y("",!0)]),t("h3",W,_(e.towerEvent.location),1),t("h6",X,_(e.towerEvent.description),1),t("h6",Y,_(new Date(e.towerEvent.startDate).toLocaleDateString()),1),e.towerEvent.capacity==0||e.towerEvent.isCanceled?(a(),s("div",Z,[t("h5",null,[t("span",$,[ee,e.towerEvent.capacity==0?(a(),s("span",te,"0 spots left.")):y("",!0)])])])):(a(),s("div",oe,[t("h5",null,[t("span",ne,_(e.towerEvent.capacity),1),se])])),e.towerEvent.capacity==0||e.towerEvent.isCanceled||e.isAttending||e.towerEvent.creatorId==e.account.id?(a(),s("button",{key:2,disabled:"",onClick:n[1]||(n[1]=r=>e.createTicket()),class:"Attend rounded bg-gradient"},ce)):(a(),s("button",{key:3,onClick:n[2]||(n[2]=r=>e.createTicket()),class:"Attend rounded bg-gradient"},le))])])])]),e.attendees.length>0?(a(),s("div",me,[ve,(a(!0),s(p,null,k(e.attendees,r=>(a(),s("img",{title:r.profile.name,class:"profile-picture",src:r.profile.picture,alt:r.profile.name},null,8,_e))),256))])):y("",!0)])])):y("",!0),t("div",he,[t("div",ue,[t("div",ge,[t("form",{onSubmit:n[4]||(n[4]=D(r=>e.createComment(),["prevent"]))},[t("div",ye,[P(t("input",{title:"Comment Field","onUpdate:modelValue":n[3]||(n[3]=r=>e.liveComment.body=r),class:"form-control comment-form w-100",type:"text"},null,512),[[V,e.liveComment.body]]),we]),pe],32)]),(a(!0),s(p,null,k(e.comments,r=>(a(),s("div",{class:"col-12 mb-4",key:r.id},[F(o,{comment:r},null,8,["comment"])]))),128))])])],64)}const Ee=C(O,[["render",fe],["__scopeId","data-v-d6b89b54"]]);export{Ee as default};
